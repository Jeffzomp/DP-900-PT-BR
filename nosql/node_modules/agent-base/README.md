---
ms.openlocfilehash: ca1f677bd38876befee833fcedd10388a71aecf4
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/05/2022
ms.locfileid: "138052973"
---
<a name="agent-base"></a>agent-base
==========
### <a name="turn-a-function-into-an-httpagenthttpagent-instance"></a>Transforme uma função em uma instância de [`http.Agent`][http.Agent]
[![Status de build](https://github.com/TooTallNate/node-agent-base/workflows/Node%20CI/badge.svg)](https://github.com/TooTallNate/node-agent-base/actions?workflow=Node+CI)

Este módulo oferece um gerador `http.Agent`. Ou seja, você passa a ele uma função de retorno de chamada assíncrona e ele retorna uma nova instância de `http.Agent`, que invocará a função de retorno de chamada determinada ao enviar solicitações HTTP de saída.

#### <a name="some-subclasses"></a>Algumas subclasses:

Veja alguns tipos de uso mais interessantes de `agent-base`.
Envie uma solicitação de pull para listar o seu.

 * [`http-proxy-agent`][http-proxy-agent]: Uma implementação de proxy HTTP(s) de `http.Agent` para pontos de extremidade HTTP
 * [`https-proxy-agent`][https-proxy-agent]: Uma implementação de proxy HTTP(s) de `http.Agent` para pontos de extremidade HTTPS
 * [`pac-proxy-agent`][pac-proxy-agent]: Uma implementação de proxy de arquivo PAC de `http.Agent` para HTTP e HTTPS
 * [`socks-proxy-agent`][socks-proxy-agent]: Uma implementação de proxy de SOCKS de `http.Agent` para HTTP e HTTPS


<a name="installation"></a>Instalação
------------

Instalar com `npm`:

``` bash
$ npm install agent-base
```


<a name="example"></a>Exemplo
-------

Aqui está um exemplo mínimo que cria uma conexão de `net.Socket` com o servidor para cada solicitação HTTP (ou seja, o equivalente à opção `agent: false`):

```js
var net = require('net');
var tls = require('tls');
var url = require('url');
var http = require('http');
var agent = require('agent-base');

var endpoint = 'http://nodejs.org/api/';
var parsed = url.parse(endpoint);

// This is the important part!
parsed.agent = agent(function (req, opts) {
  var socket;
  // `secureEndpoint` is true when using the https module
  if (opts.secureEndpoint) {
    socket = tls.connect(opts);
  } else {
    socket = net.connect(opts);
  }
  return socket;
});

// Everything else works just like normal...
http.get(parsed, function (res) {
  console.log('"response" event!', res.headers);
  res.pipe(process.stdout);
});
```

Também há suporte para retornar um Promise ou usar uma função `async`:

```js
agent(async function (req, opts) {
  await sleep(1000);
  // etc…
});
```

Retornar outra instância de `http.Agent` para "passar" a responsabilidade por essa solicitação HTTP a esse agente:

```js
agent(function (req, opts) {
  return opts.secureEndpoint ? https.globalAgent : http.globalAgent;
});
```


<a name="api"></a>API
---

## <a name="agentfunction-callback-object-options--httpagent"></a>Agent(Function callback[, Object options]) → [http.Agent][]

Cria um `http.Agent` base que executará a função de retorno de chamada `callback` para cada solicitação HTTP em que ela é usada como o `agent`. A função de retorno de chamada é responsável por criar uma instância de `stream.Duplex` de algum tipo que será usado como o soquete subjacente na solicitação HTTP.

O objeto `options` aceita as seguintes propriedades:

  * `timeout` – Número – Tempo limite para a função `callback()` em milissegundos. O padrão é Infinity (opcional).

A função de retorno de chamada deve ter a seguinte assinatura:

### <a name="callbackhttpclientrequest-req-object-options-function-cb--undefined"></a>callback(http.ClientRequest req, Object options, Function cb) → undefined

A ClientRequest `req` pode ser acessada para ler cabeçalhos de solicitação, o caminho etc. O objeto `options` contém as opções passadas à chamada de função `http.request()`/`https.request()` e é formatado para ser passado diretamente a `net.connect()`/`tls.connect()` ou de qualquer outra forma que você queira criar o soquete. Passe o soquete criado à função de retorno de chamada `cb` após a criação e a solicitação HTTP poderá continuar.

Se o módulo `https` for usado para invocar a solicitação HTTP, a propriedade `secureEndpoint` em `options` _será definida como `true`_ .


<a name="license"></a>Licença
-------

(A licença MIT)

Direitos autorais (c) 2013 Nathan Rajlich &lt;nathan@tootallnate.net&gt;

A permissão é concedida por meio deste instrumento, gratuitamente, a qualquer pessoa que obtenha uma cópia deste software e dos arquivos de documentação associados (o 'Software') para lidar com o Software sem restrição, incluindo, entre outros, os direitos de uso, cópia, modificação, mesclagem, publicação, distribuição, sublicenciamento e/ou venda de cópias do Software e a permissão para que as pessoas que receberem o Software façam isso, de acordo com as seguintes condições:

O aviso de direitos autorais acima e esta notificação de permissão deverão ser incluídos em todas as cópias ou partes substanciais do Software.

O SOFTWARE É FORNECIDO "NO ESTADO EM QUE SE ENCONTRA" SEM NENHUM TIPO DE GARANTIA, EXPLÍCITA OU IMPLÍCITA, INCLUINDO, MAS SEM LIMITAÇÃO, AS GARANTIAS DE COMERCIALIZAÇÃO, ADEQUAÇÃO A UMA FINALIDADE ESPECÍFICA E DE NÃO VIOLAÇÃO.
EM NENHUMA CIRCUNSTÂNCIA OS AUTORES OU OS DETENTORES DE DIREITOS AUTORAIS SERÃO RESPONSABILIZADOS POR QUALQUER REIVINDICAÇÃO, DANOS OU OUTRA OBRIGAÇÃO, SEJA EM UMA AÇÃO DE CONTRATO, ATO ILÍCITO EXTRACONTRATUAL OU DECORRENTES DO, EM VIRTUDE DO OU EM CONEXÃO COM O SOFTWARE, USO OU OUTRAS NEGOCIAÇÕES NO SOFTWARE.

[http-proxy-agent]: https://github.com/TooTallNate/node-http-proxy-agent
[https-proxy-agent]: https://github.com/TooTallNate/node-https-proxy-agent
[pac-proxy-agent]: https://github.com/TooTallNate/node-pac-proxy-agent
[socks-proxy-agent]: https://github.com/TooTallNate/node-socks-proxy-agent
[http.Agent]: https://nodejs.org/api/http.html#http_class_http_agent

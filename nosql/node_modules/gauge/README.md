---
ms.openlocfilehash: 81fd1455668c9343defe69cbbbff10d48b1f97ef
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050418"
---
<a name="gauge"></a>medidor
=====

Um medidor horizontal ou uma barra de progresso baseada em terminal, quase sem estado.

```javascript
var Gauge = require("gauge")

var gauge = new Gauge()

gauge.show("test", 0.20)

gauge.pulse("this")

gauge.hide()
```

![](gauge-demo.gif)


### <a name="changes-from-1x"></a>ALTERAÇÕES DO 1.x

O medidor 2.x é uma versão interruptiva. Confira o [log de alterações] para saber em detalhes o que foi alterado se você já era usuário deste módulo.

[log de alterações]: CHANGELOG.md

### <a name="the-gauge-class"></a>A CLASSE GAUGE

Essa é a interface típica do módulo, que oferece uma opção automatizada para exibir informações de status.

```
var Gauge = require("gauge")

var gauge = new Gauge([stream], [options])
```

* **stream** – *(Opcional, stderr padrão)* , um fluxo no qual as atualizações da barra de progresso devem ser gravadas.  O medidor respeita a pressão de retorno e pausa a maior parte da gravação quando a pressão é indicada.
* **options** – *(Opcional)* , um objeto de opção.

Constrói um novo medidor. Os medidores são desenhados em uma só linha e não são desenhados quando o **stream** não é um tty e não recebe um tty explicitamente.

Se o **stream** for um terminal ou se você passar o **tty** para **options**, os redimensionamentos do terminal serão detectados e ele será redesenhado para se ajustar.  Fazemos isso inspecionando se há eventos `resize` no tty.  (Para solucionar um bug nas versões do Node anteriores à 2.5.0, os inspecionamos no stdout quando o tty é stderr.) O redimensionamento da janela para tamanhos maiores sempre será limpo, mas a redução da janela sempre resultará em alguma falha.

**IMPORTANTE:** Se você estava passando um fluxo que é não tty, mas ainda quer a saída (por exemplo, um fluxo encapsulado pelo módulo `ansi`), passe a opção **tty** abaixo, pois `gauge` precisa acessar o tty subjacente para fazer coisas como redimensionamentos do terminal e detecção de largura do terminal.

O objeto **options** pode ter as seguintes propriedades, todas opcionais:

* **updateInterval**: A frequência com que as atualizações do medidor devem ser desenhadas, em milissegundos.
* **fixedFramerate**: O padrão é false no Node 0.8 e true nas opções restantes.  Quando ele é true, um temporizador é criado para disparar uma vez a cada `updateInterval` ms. Quando ele é false, as atualizações são impressas assim que chegam, mas as atualizações com uma frequência maior do que `updateInterval` são ignoradas.  O motivo pelo qual a 0.8 não tem essa opção configurada como true é que ela não consegue executar `unref` no temporizador e, portanto, impede que o programa seja encerrado. Se você quiser usar esse recurso com a 0.8, chame `gauge.disable()` antes de esperar que o programa seja encerrado.
* **themes**: Um conjunto de temas a ser usado ao selecionar o tema desejado. O padrão é `gauge/themes`, confira a documentação de [themes] para obter detalhes.
* **theme**: Selecione um tema a ser usado, que pode ser:
  * Objeto theme, nesse caso, o **themes** não é usado.
  * O nome de um tema, que será pesquisado no objeto *themes* atual.
  * Um objeto de configuração com uma das chaves `hasUnicode`, `hasColor` ou `platform`, que será usado para substituir a escolha do usuário ao fazer uma seleção de tema padrão.

  Se nenhum tema for selecionado, um padrão será escolhido usando uma combinação das melhores escolhas do usuário no sistema operacional, o suporte a cores e o suporte a Unicode.
* **template**: Descreve como deve ser a aparência do medidor.  O padrão é o que o npm usa.  A [documentação] detalhada está mais adiante neste documento.
* **hideCursor**: O padrão é true.  Se for true, o cursor ficará oculto enquanto o medidor estiver exibido.
* **tty**: O tty no qual você está gravando.  O padrão é o mesmo que o de **stream**.  Usado para detectar a largura do terminal e os redimensionamentos. A largura usada é `tty.columns - 1`. Se não houver nenhum tty disponível, a largura será assumida como `79`.
* **enabled**: O padrão é true quando `tty` é um TTY. Caso contrário, é false.  Se for true, o medidor será iniciado habilitado.  Se estiver desabilitado, todos os comandos de atualização serão ignorados e não será impresso nenhum medidor até que você chame `.enable()`.
* **Plumbing**: A classe a ser usada para realmente gerar o medidor para impressão.  O padrão é `require('gauge/plumbing')` e geralmente não é necessário substituí-lo.
* **cleanupOnExit**: O padrão é true. Normalmente, registramos um manipulador de encerramento para verificar se o cursor é ativado novamente e a barra de progresso é apagada quando o processo é encerrado, mesmo quando você sai com Ctrl-C ou sem querer. Você pode desabilitar essa opção para que o manipulador de saída não seja registrado.

[has-unicode]: https://www.npmjs.com/package/has-unicode
[themes]: #themes
[documentação]: #templates

#### `gauge.show(section | status, [completed])`

O primeiro argumento é a seção, o nome do item atual que contribui para o progresso ou um objeto com chaves como **section**, **subsection** e **completed** (ou quaisquer outros para os quais haja tipos em um modelo personalizado).  Se você não quiser atualizar nem definir nada disso, passe `null` e a opção será ignorada.

O segundo argumento é o percentual concluído como um valor entre 0 e 1.
Sem ele, a conclusão simplesmente não é atualizada. Você também observará que a conclusão pode ser passada como parte de um objeto de status como o primeiro argumento. Se ele e o argumento concluído forem passados, o argumento concluído vencerá.

#### `gauge.hide([cb])`

Remove o medidor do terminal.  Opcionalmente, o retorno de chamada `cb` depois que a E/S teve oportunidade de acontecer (no momento, isso significa apenas após o retorno de chamada de `setImmediate`).

Isso é importante quando você está pausando a barra de progresso em um filehandle e imprimindo em outro. Caso contrário, (com uma impressão grande o suficiente) o Node pode acabar imprimindo os bits da "barra de progresso final" no filehandle da barra de progresso enquanto outras coisas estão imprimindo em outro filehandle. Essas intercalações podem causar corrupção em alguns terminais.

#### `gauge.pulse([subsection])`

* **subsection** – *(Opcional)* , o motivo específico que disparou esse pulso

Gira o controle giratório no medidor para mostrar a saída.  Se **subsection** estiver incluída, ela será combinada com o último nome passado para `gauge.show`.

#### `gauge.disable()`

Oculta o medidor e ignora outras chamadas para `show` ou `pulse`.

#### `gauge.enable()`

Mostra o medidor e retoma a atualização quando `show` ou `pulse` é chamado.

#### `gauge.isEnabled()`

Retorna true quando o medidor é calibrado.

#### `gauge.setThemeset(themes)`

Alterar o conjunto de temas para selecionar um tema. O mesmo que a opção `themes` usada no construtor. Haverá uma nova seleção de tema neste conjunto de temas.

#### `gauge.setTheme(theme)`

Alterar o tema ativo. Será exibido com o próximo show ou pulse. Isso pode ser:

* Objeto theme, nesse caso, o **themes** não é usado.
* O nome de um tema, que será pesquisado no objeto *themes* atual.
* Um objeto de configuração com uma das chaves `hasUnicode`, `hasColor` ou `platform`, que será usado para substituir a escolha do usuário ao fazer uma seleção de tema padrão.

Se nenhum tema for selecionado, um padrão será escolhido usando uma combinação das melhores escolhas do usuário no sistema operacional, o suporte a cores e o suporte a Unicode.

#### `gauge.setTemplate(template)`

Alterar o modelo ativo. Será exibido com o próximo show ou pulse

### <a name="tracking-completion"></a>Acompanhamento da conclusão

Se houver mais de uma ação acontecendo cuja conclusão você queira acompanhar, o [are-we-there-yet] relacionado poderá ajudar.  O evento `change` pode ser conectado ao método `show` para proporcionar uma interface de barra de progresso mais tradicional.

[are-we-there-yet]: https://www.npmjs.com/package/are-we-there-yet

### <a name="themes"></a>THEMES

```
var themes = require('gauge/themes')

// fetch the default color unicode theme for this platform
var ourTheme = themes({hasUnicode: true, hasColor: true})

// fetch the default non-color unicode theme for osx
var ourTheme = themes({hasUnicode: true, hasColor: false, platform: 'darwin'})

// create a new theme based on the color ascii theme for this platform
// that brackets the progress bar with arrows
var ourTheme = themes.newTheme(theme(hasUnicode: false, hasColor: true}), {
  preProgressbar: '→',
  postProgressbar: '←'
})
```

O objeto retornado por `gauge/themes` é uma instância da classe `ThemeSet`.

```
var ThemeSet = require('gauge/theme-set')
var themes = new ThemeSet()
// or
var themes = require('gauge/themes')
var mythemes = themes.newThemeset() // creates a new themeset based on the default themes
```

#### <a name="themesopts"></a>themes(opts)
#### <a name="themesgetdefaultopts"></a>themes.getDefault(opts)

Os objetos de tema são uma função que busca o tema padrão com base no suporte à plataforma, no Unicode e nas cores.

As opções são um objeto com as seguintes propriedades:

* **hasUnicode** – Quando true, um tema Unicode será buscado e, se não houver nenhum tema Unicode disponível, um tema que não é Unicode será usado.
* **hasColor** – Quando true, um tema de cor será buscado e, se não houver nenhum tema de cor, um tema sem cor será usado.
* **platform** (opcional) – O padrão é `process.platform`.  Se não houver nenhuma correspondência de plataforma disponível, `fallback` será usado.

Se nenhum tema compatível for encontrado, um erro será gerado com o `code` igual a `EMISSINGTHEME`.

#### <a name="themesaddthemethemename-themeobj"></a>themes.addTheme(themeName, themeObj)
#### <a name="themesaddthemethemename-parenttheme-newtheme"></a>themes.addTheme(themeName, [parentTheme], newTheme)

Adiciona um tema nomeado ao conjunto de temas.  Você pode passar um objeto de tema retornado por `themes.newTheme` ou os argumentos que passaria para `themes.newTheme`.

#### <a name="themesgetthemenames"></a>themes.getThemeNames()

Retornar uma lista de todos os nomes dos temas nesse conjunto de temas. Adequado para uso com `themes.getTheme(…)`.

#### <a name="themesgetthemename"></a>themes.getTheme(name)

Retorna o objeto de tema desse conjunto de temas chamado `name`.

Se `name` não existir neste conjunto de temas, um erro será gerado com o `code` igual a `EMISSINGTHEME`.

#### <a name="themessetdefaultopts-themename"></a>themes.setDefault([opts], themeName)

`opts` é um objeto com as propriedades a seguir.

* **platform** – O padrão é `'fallback'`.  Se o tema for específico da plataforma, especifique isso aqui com a plataforma de `process.platform`, por exemplo, `win32`, `darwin` etc.
* **hasUnicode** – O padrão é `false`. Se o tema usa Unicode, defina essa opção como true.
* **hasColor** – O padrão é `false`.  Se o tema usa cor, defina essa opção como true.

`themeName` é o nome do tema (dado a `addTheme`) a ser usado para esse conjunto de `opts`.

#### <a name="themesnewthemeparenttheme-newtheme"></a>themes.newTheme([parentTheme,] newTheme)

Criar um objeto de tema com base em `parentTheme`.  Se não for fornecido nenhum `parentTheme`, será definido um parentTheme mínimo que define funções para renderizar o indicador de atividade (controle giratório) e a barra de progresso. (Esse pai de fallback é definido em `gauge/base-theme`.)

newTheme deve ser um objeto básico. Vamos começar discutindo as propriedades definidas pelos temas padrão:

* **preProgressbar** – Exibida antes da barra de progresso, quando a barra de progresso é exibida.
* **postProgressbar** – Exibida depois da barra de progresso, quando a barra de progresso é exibida.
* **progressBarTheme** – O subtema passado pelo renderizador da barra de progresso. É um objeto com as propriedades `complete` e `remaining` que são as cadeias de caracteres que você quer repetir nas seções da barra de progresso.
* **activityIndicatorTheme** – O tema do indicador de atividade (controle giratório). Pode ser uma cadeia de caracteres, na qual cada caractere é uma etapa diferente ou uma matriz de cadeias de caracteres.
* **preSubsection** – Exibida como um separador entre `section` e `subsection` quando `subsection` é impresso.

Em geral, os temas podem ter qualquer valor que seja um valor válido durante a renderização de modelos. As propriedades no tema são usadas quando o nome corresponde a um tipo no modelo. Os valores podem ser:

* **cadeias de caracteres e números** – Eles serão incluídos no estado em que se encontram
* **função (valores, tema, largura)** – Devem retornar o que você deseja na saída.
  *values* é um objeto com valores fornecidos por meio `gauge.show`. *theme* é o tema específico desse item (veja abaixo) ou esse objeto theme, e *width* é o número de caracteres de largura que o resultado deve ser.

Há alguns prefixos especiais:

* **pre** – É mostrado antes da propriedade, quando ela é exibida.
* **post** – É mostrado após a propriedade, quando ela é exibida.

E um sufixo especial:

* **Theme** – Seu valor é passado para um item de tipo de função como o tema.

#### <a name="themesaddtoallthemestheme"></a>themes.addToAllThemes(theme)

Essa opção *combina* o `theme` em todos os temas definidos no momento. Ela também o adiciona ao tema pai padrão desse conjunto de temas, para que os próximos temas adicionados a esse conjunto de temas obtenham os valores de `theme` por padrão.

#### <a name="themesnewthemeset"></a>themes.newThemeset()

Copiar o conjunto de temas atual em um novo.  Isso permite herdar facilmente um conjunto de temas de outro.

### <a name="templates"></a>MODELOS

Um modelo é uma matriz de objetos e cadeias de caracteres que, após serem avaliados, serão transformadas na linha do medidor.  O modelo padrão é:

```javascript
[
    {type: 'progressbar', length: 20},
    {type: 'activityIndicator', kerning: 1, length: 1},
    {type: 'section', kerning: 1, default: ''},
    {type: 'subsection', kerning: 1, default: ''}
]
```

Os vários elementos de modelo podem ser **cadeias de caracteres simples** e, nesse caso, eles serão incluídos literalmente na saída, ou objetos com as seguintes propriedades:

* *type* pode ser uma das opções a seguir além das chaves que você passar para `gauge.show` e todas as chaves contidas em um tema personalizado.
  * `section` – Qual trabalho principal você está realizando agora.
  * `subsection` – Qual componente desse trabalho está funcionando no momento.
  * `activityIndicator` – Mostra um controle giratório usando o `activityIndicatorTheme` do tema ativo.
  * `progressbar` – Uma barra de progresso que representa o `completed` atual usando o `progressbarTheme` do tema ativo.
* *kerning* – Número de espaços que precisam estar entre esse item e outros itens, quando esse item é exibido.
* *maxLength* – O comprimento máximo desse elemento. Se o valor for mais longo, ele será truncado.
* *minLength* – O comprimento mínimo desse elemento. Se o valor for menor, ele será preenchido de acordo com o valor de *align*.
* *align* – (Padrão: esquerda), os valores possíveis são "left", "right" e "center". Funciona da mesma forma que os processadores de palavras.
* *length* – Fornece um só valor para *minLength* e *maxLength*. Se *length* e *minLength* ou *maxLength* forem especificados, maxLength terá precedência.
* *value* – Um valor literal a ser usado para esse item de modelo.
* *default* – Um valor padrão a ser usado para esse item de modelo quando não é passado um valor de outra forma.

### <a name="plumbing"></a>PLUMBING

Essa é a mágica interna super simples e sem suposições usada pelo medidor para implementar sua interface comum.

```
var Plumbing = require('gauge/plumbing')
var gauge = new Plumbing(theme, template, width)
```

* **theme**: O tema a ser usado.
* **template**: O modelo a ser usado.
* **width**: A largura que o medidor deve ter

#### `gauge.setTheme(theme)`

Alterar o tema ativo.

#### `gauge.setTemplate(template)`

Alterar o modelo ativo.

#### `gauge.setWidth(width)`

Alterar a largura de destino da renderização.

#### `gauge.hide()`

Retornar a cadeia de caracteres necessária para ocultar a barra de progresso

#### `gauge.hideCursor()`

Retornar uma cadeia de caracteres para ocultar o cursor.

#### `gauge.showCursor()`

Retornar uma cadeia de caracteres para mostrar o cursor.

#### `gauge.show(status)`

Usando valores `status`, renderizar o modelo fornecido com o tema e retornar uma cadeia de caracteres adequada para impressão a fim de atualizar o medidor.

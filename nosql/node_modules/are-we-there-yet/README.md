---
ms.openlocfilehash: 34b661fbb1237d51bdab932626d19518225841a0
ms.sourcegitcommit: e739004291428ce83f14b9d49f1e9dfaa3762dde
ms.translationtype: HT
ms.contentlocale: pt-BR
ms.lasthandoff: 02/05/2022
ms.locfileid: "138050429"
---
<a name="are-we-there-yet"></a>are-we-there-yet
----------------

Acompanhar hierarquias complexas de status de conclusão de tarefas assíncronas.  Visa oferecer uma forma de gravar e relatar o progresso do grande fan-out recursivo e coletar fluxos de trabalho de tipo que são tão comuns no modo assíncrono.

O que você faz com esses dados de conclusão cabe a você, mas o caso de uso mais comum é enviá-los a um dos vários módulos da barra de progresso.

A maioria dos módulos da barra de progresso inclui uma versão básica desta opção, mas minhas necessidades eram mais complexas.

<a name="usage"></a>Uso
=====

```javascript
var TrackerGroup = require("are-we-there-yet").TrackerGroup

var top = new TrackerGroup("program")

var single = top.newItem("one thing", 100)
single.completeWork(20)

console.log(top.completed()) // 0.2

fs.stat("file", function(er, stat) {
  if (er) throw er  
  var stream = top.newStream("file", stat.size)
  console.log(top.completed()) // now 0.1 as single is 50% of the job and is 20% complete
                              // and 50% * 20% == 10%
  fs.createReadStream("file").pipe(stream).on("data", function (chunk) {
    // do stuff with chunk
  })
  top.on("change", function (name) {
    // called each time a chunk is read from "file"
    // top.completed() will start at 0.1 and fill up to 0.6 as the file is read
  })
})
```

<a name="shared-methods"></a>Métodos compartilhados
==============

* var completed = tracker.completed()

Implementado em: `Tracker`, `TrackerGroup`, `TrackerStream`

Retorna a taxa de trabalho concluído para o trabalho a ser feito. Intervalo de 0 a 1.

* tracker.finish()

Implementado em: `Tracker`, `TrackerGroup`

Marca o rastreador como concluído. Com um TrackerGroup, essa opção marca todos os componentes como concluídos.

Marca todos os componentes desse rastreador como concluídos, o que, por sua vez, significa que `tracker.completed()` para isso agora será 1.

Isso resultará na emissão de um ou mais eventos `change`.

<a name="events"></a>Eventos
======

Todos os objetos de rastreador emitem eventos `change` com os seguintes argumentos:

```
function (name, completed, tracker)
```

`name` é o nome do rastreador que emitiu o evento originalmente ou se ele não tinha nenhum, o primeiro grupo de rastreadores que tinha um.

`completed` é o percentual concluído (retornado pelo método `tracker.completed()`).

`tracker` é o objeto rastreador no qual você está escutando eventos.

<a name="trackergroup"></a>TrackerGroup
============

* var tracker = new TrackerGroup(**name**)

  * **name** *(opcional)* – O nome desse grupo de rastreadores, usado em notificações de alteração quando a atualização do componente não tem um nome. O padrão é indefinido.

Cria um grupo de agregação de rastreador vazio. São rastreadores cujo status de conclusão é determinado pelo status de conclusão de outros rastreadores.

* tracker.addUnit(**otherTracker**, **weight**)

  * **otherTracker** – Qualquer um dos outros objetos rastreadores are-we-there-yet
  * **weight** *(opcional)* – O peso a ser dado ao rastreador. O padrão 1.

Adiciona o **otherTracker** a esse grupo de agregação. O peso determina quanto tempo você espera que esse rastreador leve para ser concluído proporcionalmente a outras unidades.  Portanto, por exemplo, se você adicionar um rastreador com o peso 1 e outro com o peso 2, você está dizendo que o segundo levará duas vezes mais tempo para ser concluído do que o primeiro.  Assim, o primeiro responderá por 33% da conclusão desse rastreador e o segundo responderá pelos outros 67%.

Retorna **otherTracker**.

* var subGroup = tracker.newGroup(**name**, **weight**)

O exemplo acima é equivalente a:

```javascript
  var subGroup = tracker.addUnit(new TrackerGroup(name), weight)
```

* var subItem = tracker.newItem(**name**, **todo**, **weight**)

O exemplo acima é equivalente a:

```javascript
  var subItem = tracker.addUnit(new Tracker(name, todo), weight)
```

* var subStream = tracker.newStream(**name**, **todo**, **weight**)

O exemplo acima é equivalente a:

```javascript
  var subStream = tracker.addUnit(new TrackerStream(name, todo), weight)
```

* console.log( tracker.debug() )

Retorna uma árvore mostrando a conclusão desse grupo de rastreadores e de todos os filhos, incluindo a inserção recursiva de todos os filhos.

<a name="tracker"></a>Monitoramento
=======

* var tracker = new Tracker(**name**, **todo**)

  * **name** *(opcional)* O nome desse contador a ser relatado em eventos de alteração.  O padrão é indefinido.
  * **todo** *(opcional)* A quantidade de trabalho a ser feito (um número). Assume o padrão de 0.

Normalmente, eles são construídos como parte de um grupo de rastreadores (por meio de `newItem`).

* var completed = tracker.completed()

Retorna a taxa de trabalho concluído para o trabalho a ser feito. Intervalo de 0 a 1. Se o trabalho total a ser feito for 0, ele retornará 0.

* tracker.addWork(**todo**)

  * **todo** Um número a ser adicionado à quantidade de trabalho a ser feita.

Aumenta a quantidade de trabalho a ser feito, diminuindo assim o percentual de conclusão.  Dispara um evento `change`.

* tracker.completeWork(**completed**)

  * **completed** Um número a ser adicionado ao trabalho concluído

Aumentar a quantidade de trabalho concluída, aumentando assim o percentual de conclusão.
Nunca aumentará o trabalho concluído além da quantidade de trabalho a ser feita. Ou seja, percentuais maiores que 100% não são permitidos. Dispara um evento `change`.

* tracker.finish()

Marca este rastreador como concluído, tracker.completed() agora será 1. Dispara um evento `change`.

<a name="trackerstream"></a>TrackerStream
=============

* var tracker = new TrackerStream(**name**, **size**, **options**)

  * **name** *(opcional)* O nome desse contador a ser relatado em eventos de alteração.  O padrão é indefinido.
  * **size** *(opcional)* O número de bytes que estão sendo enviados por esse fluxo.
  * **options** *(opcional)* Um hash de opções de fluxo

O objeto de fluxo de rastreador é um fluxo de passagem que atualiza um objeto rastreador interno sempre que um bloco é passado.  Ele visa acompanhar downloads, extração de arquivos e outras atividades relacionadas. Use-o canalizando a fonte de dados para ele e depois usando-a como sua fonte de dados.

Se os dados tiverem um atributo de comprimento, ele será usado como a quantidade de trabalho concluída quando a parte for passada.  Se não (por exemplo, fluxos de objeto), cada parte contará como concluindo uma unidade de trabalho, portanto, o tamanho será o número total de objetos que estejam sendo transmitidos.

* tracker.addWork(**todo**)

  * **todo** Aumentar o tamanho geral esperado em bytes de **todo**.

Aumenta a quantidade de trabalho a ser feito, diminuindo assim o percentual de conclusão.  Dispara um evento `change`.
